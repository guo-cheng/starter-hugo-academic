---
title: ç”Ÿç‰©ä¿¡æ¯å­¦å…¥é—¨è¯¾ï¼šå­¦ä¹ ç”Ÿä¿¡ä½ éœ€è¦äº†è§£çš„ç»Ÿè®¡å­¦
subtitle: è¿™ç¯‡å­¦ä¹ ç¬”è®°ä¸»è¦å‚è€ƒåŒ—å¤§ç”Ÿç§‘é™¢å­Ÿæµ©å·åšå£«åœ¨è…¾è®¯è¯¾å ‚å¼€è®¾çš„è¯¾ç¨‹(ååˆ†æ¨èå­¦ä¹ )

# Summary for listings and search engines
summary: è¿™ç¯‡å­¦ä¹ ç¬”è®°ä¸»è¦å‚è€ƒåŒ—å¤§ç”Ÿç§‘é™¢å­Ÿæµ©å·åšå£«åœ¨è…¾è®¯è¯¾å ‚å¼€è®¾çš„è¯¾ç¨‹(ååˆ†æ¨èå­¦ä¹ )

# Link this post with a project
projects: [Data Science]

# Date published
date: "2021-2-3T00:00:00Z"

# Date updated
lastmod: "2020-2-3T00:00:00Z"

# Is this an unpublished draft?
draft: false

# Show this page in the Featured widget?
featured: false

# Featured image
# Place an image named `featured.jpg/png` in this page's folder and customize its options here.
image:
  caption: ''
  focal_point: ""
  placement: 2
  preview_only: false

authors:
- admin

tags:
- ç”Ÿç‰©ä¿¡æ¯
- ç»Ÿè®¡

categories:
- ç»Ÿè®¡å­¦
- æ•™ç¨‹
---

# ç»Ÿè®¡å­¦ä¹ 

è¿™ç¯‡å­¦ä¹ ç¬”è®°ä¸»è¦å‚è€ƒåŒ—å¤§ç”Ÿç§‘é™¢å­Ÿæµ©å·åšå£«åœ¨è…¾è®¯è¯¾å ‚å¼€è®¾çš„è¯¾ç¨‹(ååˆ†æ¨èå­¦ä¹ )ï¼š

> ç”Ÿç‰©ä¿¡æ¯å­¦å…¥é—¨è¯¾ï¼šå­¦ä¹ ç”Ÿä¿¡ä½ éœ€è¦äº†è§£çš„ç»Ÿè®¡å­¦

æœ¬ç¯‡ç¬”è®°æˆªæ­¢åˆ°å¤šé‡å‡è®¾æ£€éªŒçš„çŸ«æ­£ï¼Œè¿‡å‡ å¤©å†æ›´æ–°ä½™ä¸‹å†…å®¹ã€‚

**è¯¾ç¨‹ä¸»è¦ç›®å½•åŠå†…å®¹**
**ç»Ÿè®¡å­¦åŸºç¡€çŸ¥è¯†ï¼š**

- ä»€ä¹ˆæ˜¯æ¦‚ç‡ï¼Ÿ
- ä»€ä¹ˆæ˜¯éšæœºå˜é‡ï¼Ÿ
- æ¦‚ç‡å¯†åº¦å‡½æ•°åŠç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼›
- boxplotä¸histogramï¼›
- æœ€é‡è¦çš„è‹¥å¹²åˆ†å¸ƒï¼ˆç¦»æ•£+è¿ç»­ï¼‰ï¼›
  - äºŒé¡¹åˆ†å¸ƒï¼›
  - æ³Šæ¾åˆ†å¸ƒï¼›
  - è´ŸäºŒé¡¹åˆ†å¸ƒï¼›
  - å‡ ä½•åˆ†å¸ƒï¼›
  - è¶…å‡ ä½•åˆ†å¸ƒï¼›
  - æŒ‡æ•°åˆ†å¸ƒï¼›
  - æ­£æ€åˆ†å¸ƒï¼›
  - Gammaåˆ†å¸ƒï¼›

**ç»Ÿè®¡æ£€éªŒç›¸å…³ï¼š**

- ä»€ä¹ˆæ˜¯å‡è®¾æ£€éªŒï¼Ÿ
  - å¥³å£«å“èŒ¶ä¸Pearsonæ‹Ÿåˆä¼˜åº¦æ£€éªŒï¼›
  - P valueæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæ€ä¹ˆè®¡ç®—ï¼Ÿ
  - ä»€ä¹ˆæ˜¯ç¬¬1ç±»é”™è¯¯ï¼Œä»€ä¹ˆæ˜¯ç¬¬2ç±»é”™è¯¯ï¼Ÿ
  - P valueä½¿ç”¨å¸¸è§é”™è¯¯æœ‰å“ªäº›ï¼Ÿ
  - ä»€ä¹ˆæ˜¯ç»Ÿè®¡æ£€éªŒçš„åŠŸæ•ˆï¼Ÿ
- tæ£€éªŒä¸“é¢˜ï¼›
  - ä¸ºä»€ä¹ˆè¦ç”¨tæ£€éªŒï¼Ÿ
  - tæ£€éªŒçš„å‰ææ˜¯ä»€ä¹ˆï¼Ÿ
  - å¦‚ä½•è¿›è¡Œé…å¯¹tæ£€éªŒï¼Ÿ
- åˆ—è”è¡¨æ£€éªŒé—®é¢˜
  - Fisher exact testå’Œå¡æ–¹æ£€éªŒï¼›
  - ä»2Ã—2åˆ°mÃ—nçš„æ¨å¹¿ï¼›

**å…¶ä»–å†…å®¹ï¼š**

- å¤šé‡æ£€éªŒçš„çŸ«æ­£é—®é¢˜ï¼›
  - ä»€ä¹ˆæ˜¯P valueä»€ä¹ˆæ˜¯Q Valueï¼Ÿ
- æ–¹å·®åˆ†æï¼›
- ç®€å•çš„å›å½’åˆ†æï¼›
  - ä»€ä¹ˆæ—¶å€™è¦ç”¨Pearsonç›¸å…³ç³»æ•°ï¼Œä»€ä¹ˆæ—¶å€™ç”¨Spearmanç›¸å…³ç³»æ•°ï¼Ÿ
  - ä»€ä¹ˆæ˜¯å†³å®šç³»æ•°ï¼Ÿ
  - å›å½’åˆ†æä¸­çš„P Valueåˆ°åº•æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ
- æ¯”è¾ƒé‡è¦çš„éå‚æ£€éªŒæ–¹æ³•ï¼›

## éšæœºå˜é‡ä¸æ¦‚ç‡

### éšæœºå˜é‡å’Œéšæœºè¯•éªŒ

> éšæœºè¯•éªŒçš„ç‰¹ç‚¹æ˜¯ï¼šæ‰€æœ‰å¯èƒ½å·²çŸ¥ï¼Œä½†è¯•éªŒå‰ç»“æœæœªçŸ¥ã€‚
>
> ğ‘‹æ˜¯éšç€è¯•éªŒçš„ç»“æœçš„ä¸åŒè€Œå˜åŒ–çš„ï¼Œä¹Ÿå³å®ƒæ˜¯æ ·æœ¬ç‚¹çš„ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªé‡ç§°ä¸ºéšæœºå˜é‡ã€‚

### ç¦»æ•£å‹éšæœºå˜é‡å’Œè¿ç»­å‹éšæœºå˜é‡

> éšæœºå˜é‡æ‰€æœ‰å¯èƒ½å–çš„å€¼ä¸ºæœ‰é™ä¸ªæˆ–è‡³å¤šå¯åˆ—ä¸ªï¼Œå³æˆ‘ä»¬èƒ½æŠŠå…¶å¯èƒ½çš„ç»“æœä¸€ä¸€åˆ—ä¸¾å‡ºæ¥ã€‚
>
> å…¨éƒ¨å¯èƒ½å–å€¼ä¸ä»…æ— ç©·å¤šï¼Œè€Œä¸”è¿˜ä¸èƒ½ä¸€ä¸€åˆ—ä¸¾ï¼Œè€Œæ˜¯å……æ»¡ä¸€ä¸ªåŒºé—´ã€‚

### æ¦‚ç‡çš„å…¬ç†åŒ–å®šä¹‰

- ç»è¿‡å¤§é‡è¯•éªŒï¼Œç”¨é¢‘ç‡ä»£æ›¿æ¦‚ç‡ã€‚

> 1. 0 â‰¤ P(A) â‰¤ 1
> 2. P(S) = 1
> 3. è‹¥A~1~ï¼ŒA~2~, â€¦ , A~k~ï¼›ä¸¤ä¸¤äº’ä¸ç›¸å®¹ï¼Œåˆ™![cFBOPo](https://cdn.liguocheng.top//uPic/cFBOPo.png)
>
> è‹¥æ»¡è¶³ä¸Šè¿°3ç‚¹ï¼Œåˆ™P(A) ç§°ä¸ºäº‹ä»¶Açš„æ¦‚ç‡ã€‚
>
> P(H) = P(T) 
>
> P(H) + P(T) = 1 
>
> å¯è§£ï¼šP(H) = 0.5

### éšæœºå˜é‡çš„æ¦‚ç‡åˆ†å¸ƒå¾‹ä¸æ¦‚ç‡å¯†åº¦å‡½æ•°

- ç¦»æ•£å‹éšæœºå˜é‡

![image-20210705163125383](https://cdn.liguocheng.top//uPic/image-20210705163125383.png)

- ç¦»æ•£å‹éšæœºå˜é‡

![image-20210705163213763](https://cdn.liguocheng.top//uPic/image-20210705163213763.png)

### æ¦‚ç‡åˆ†å¸ƒå‡½æ•°

- ç¦»æ•£å‹éšæœºå˜é‡å’Œç¦»æ•£å‹éšæœºå˜é‡éƒ½å¯ä»¥æ±‚æ¦‚ç‡åˆ†å¸ƒå‡½æ•°F(X)ã€‚

![image-20210705163345612](https://cdn.liguocheng.top//uPic/image-20210705163345612.png)

![image-20210705163509873](https://cdn.liguocheng.top//uPic/image-20210705163509873.png)

## å¸¸è§ç¦»æ•£éšæœºåˆ†å¸ƒ

### äºŒé¡¹åˆ†å¸ƒ

> å‡è®¾ä¸€æ¬¡è¯•éªŒä¸­ï¼Œäº‹ä»¶Aå‡ºç°çš„æ¦‚ç‡ä¸ºpã€‚ç°è¿›è¡Œnæ¬¡è¯•éªŒï¼Œä»¤X = äº‹ä»¶Aå‡ºç°çš„æ¬¡æ•°ï¼Œåˆ™Xæœä»äºŒé¡¹åˆ†å¸ƒã€‚

![image-20210705222237260](https://cdn.liguocheng.top//uPic/image-20210705222237260.png)

- é‡è¦æ€§è´¨ï¼š

1. å›ºå®šn, pæ—¶ï¼Œb(k; n, p)å…ˆéškå¢åŠ è€Œå¢å¤§ï¼Œè¾¾åˆ°æŸä¸€æå¤§å€¼ååˆé€æ¸ä¸‹é™ã€‚

2. ä½¿b(k; n, p)å–æœ€å¤§å€¼çš„é¡¹b(m; n, p)ç§°ä¸ºb(k; n, p) çš„ä¸­å¿ƒé¡¹ï¼Œè€Œmç§°ä¸ºæœ€å¯èƒ½æˆåŠŸæ¬¡æ•°ã€‚

3. å›ºå®šnæ—¶ï¼Œpè¶Šä¸1/2æ¥è¿‘æ—¶ï¼Œåˆ†å¸ƒè¶Šæ¥è¿‘å¯¹ç§°ã€‚

- ç”Ÿç‰©ä¿¡æ¯å­¦åº”ç”¨ï¼š

åœ¨åŸºå› ç»„ä¸Šè¿›è¡Œmutationåˆ¤æ–­çš„æ—¶å€™ï¼Œæœ€ç®€å•çš„åŠæ³•å°±æ˜¯åˆ©ç”¨äºŒé¡¹åˆ†å¸ƒè¿›è¡Œæ£€éªŒã€‚

1. è®¡ç®—genome-wideçš„æ‰€æœ‰çªå˜ç‡å½“åšå‚æ•°p

2. è®¡ç®—æŸä¸€ä¸ªç‰¹å®šä½ç‚¹çªå˜readsæ•°ç›®kå’Œæ€»readsæ•°ç›®n

3. å¯ä»¥è®¡ç®—å‡ºä¸€ä¸ªåœ¨è¿™ç§æƒ…å†µä¸‹æ»¡è¶³æ¡ä»¶çš„pvalue

4. æœ€ç»ˆåˆ¤æ–­è¯¥ä½ç½®æ˜¯å¦ä¸ºmutationï¼Œè¿˜æ˜¯éšæœºçªå˜é€ æˆçš„ã€‚

> äºŒé¡¹åˆ†å¸ƒç¼ºç‚¹ï¼šè®¡ç®—é‡å·¨å¤§ã€‚æ‰€ä»¥ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨nå¾ˆå¤§ï¼Œpå¾ˆå°ï¼Œnpä¸å¤§çš„æ—¶å€™ç”¨æ³Šæ¾åˆ†å¸ƒè¿›è¡Œæ‹Ÿåˆï¼Œæ•ˆæœéå¸¸å¥½ã€‚
>
> ä¸€èˆ¬p < 0.1; np < 10

### æ³Šæ¾åˆ†å¸ƒ

è‹¥æŠŠåœ¨æ¯æ¬¡è¯•éªŒä¸­å‡ºç°æ¦‚ç‡å¾ˆå°çš„äº‹ä»¶ç§°ä½œç¨€æœ‰äº‹ä»¶,æ³Šæ¾åˆ†å¸ƒå¯ç”¨æ¥æè¿°ä¸€å®šæ—¶é—´å†…ç¨€æœ‰äº‹ä»¶å‡ºç°çš„æ¬¡æ•°.

- å…¨åŸºå› ç»„æµ‹åºï¼Œæ¯”å¯¹åˆ°æŸä¸€ä¸ªåŒºåŸŸå†…çš„reads count

- RNA-Seqæµ‹åºï¼Œ1ä¸ªgeneå†…æ¯”å¯¹åˆ°çš„reads count

è‹¥éšæœºå˜é‡Xå¯å–ä¸€åˆ‡éè´Ÿæ•´æ•°å€¼ï¼Œä¸”ç›¸åº”çš„æ¦‚ç‡åˆ†å¸ƒä¸ºï¼š

![image-20210706095713855](https://cdn.liguocheng.top//uPic/image-20210706095713855.png)

#### æ³Šæ¾å®šç†

æ³Šæ¾å®šç†è¡¨æ˜ï¼Œæ³Šæ¾åˆ†å¸ƒæ˜¯äºŒé¡¹åˆ†å¸ƒçš„æé™åˆ†å¸ƒï¼Œå½“næ¯”è¾ƒå¤§ï¼Œpæ¯”è¾ƒå°(ä¸€èˆ¬pè¦æ±‚å°äº0.1)æ—¶ï¼ŒäºŒé¡¹åˆ†å¸ƒå°±å¯è¿‘ä¼¼åœ°çœ‹æˆæ˜¯å‚æ•°ä¸ºnpçš„æ³Šæ¾åˆ†å¸ƒã€‚

![image-20210706100124560](https://cdn.liguocheng.top//uPic/image-20210706100124560.png)

```R
n = 100000
p = 10^(-4)

# use binomial
pbinom(0,size = n,prob = p)
pbinom(1,size = n,prob = p)
pbinom(2,size = n,prob = p)

# use possion
ppois(0,lambda = n*p)
ppois(1,lambda = n*p)
ppois(2,lambda = n*p)
```

### è¶…å‡ ä½•åˆ†å¸ƒ

å¯¹Nä»¶äº§å“ï¼ˆå…¶ä¸­M ä»¶æ¬¡å“ï¼‰è¿›è¡Œä¸æ”¾å›æŠ½æ ·æ£€æŸ¥ï¼Œç°éšæœºæŠ½å‡ºnä»¶äº§å“ï¼Œåˆ™è¿™nä»¶äº§å“ä¸­å‡ºç°çš„æ¬¡å“æ•°æœä»è¶…å‡ ä½•åˆ†å¸ƒã€‚

![image-20210706100626673](https://cdn.liguocheng.top//uPic/image-20210706100626673.png)

è¶…å‡ ä½•åˆ†å¸ƒä»¥äºŒé¡¹åˆ†å¸ƒä¸ºæé™åˆ†å¸ƒã€‚å³äºŒé¡¹åˆ†å¸ƒæ˜¯æœ‰æ”¾å›çš„æŠ½æ ·ï¼Œè¶…å‡ ä½•åˆ†å¸ƒæ˜¯æ— æ”¾å›çš„æŠ½æ ·ã€‚Fisher Exact Testå°±æ˜¯åˆ©ç”¨è¶…å‡ ä½•åˆ†å¸ƒæ£€éªŒã€‚

### å‡ ä½•åˆ†å¸ƒ

åœ¨äº‹ä»¶Aå‘ç”Ÿçš„æ¦‚ç‡ä¸ºpçš„é‡å¤ä¼¯åŠªåˆ©è¯•éªŒ(äºŒé¡¹åˆ†å¸ƒ)ä¸­ï¼Œè‹¥ä»¥Xè®°Aé¦–æ¬¡æˆåŠŸå‡ºç°æ—¶çš„è¯•éªŒæ¬¡æ•°ï¼Œåˆ™Xæœä»å‡ ä½•åˆ†å¸ƒ,ç®€è®°X~G(p)ã€‚

![image-20210706100828873](https://cdn.liguocheng.top//uPic/image-20210706100828873.png)

> q = (1 - p)

![image-20210706100914535](https://cdn.liguocheng.top//uPic/image-20210706100914535.png)

#### å‡ ä½•åˆ†å¸ƒçš„æ— è®°å¿†æ€§

ç°åœ¨å‡å®šå·²çŸ¥åœ¨å‰mæ¬¡è¯•éªŒä¸­æ²¡æœ‰å‡ºç°æˆåŠŸï¼Œé‚£ä¹ˆä¸ºäº†è¾¾åˆ°é¦–æ¬¡æˆåŠŸæ‰€å†éœ€è¦çš„ç­‰å¾…æ—¶é—´ä¸å‰é¢çš„å¤±è´¥æ¬¡æ•°mæ— å…³ã€‚

![image-20210706101046754](https://cdn.liguocheng.top//uPic/image-20210706101046754.png)

åœ¨ç¦»æ•£å‹åˆ†å¸ƒä¸­ï¼Œåªæœ‰å‡ ä½•åˆ†å¸ƒæ‰å…·æœ‰æ— è®°å¿†æ€§ã€‚

### è´ŸäºŒé¡¹åˆ†å¸ƒ(å¸•æ–¯å¡åˆ†å¸ƒ)

åœ¨æˆåŠŸçš„æ¦‚ç‡ä¸ºpçš„ä¼¯åŠªåˆ©è¯•éªŒä¸­ï¼Œè‹¥ä»¥Xè®°ç¬¬ræ¬¡æˆåŠŸå‡ºç°æ—¶çš„è¯•éªŒæ¬¡æ•°ï¼Œåˆ™Xæœä»å‚æ•°ä¸º(r, p)çš„è´ŸäºŒé¡¹åˆ†å¸ƒï¼ˆå¸•æ–¯å¡åˆ†å¸ƒï¼‰ï¼ŒXå¯å–çš„å€¼ä¸ºr, r+1ï¼Œâ€¦

![image-20210706101312469](https://cdn.liguocheng.top//uPic/image-20210706101312469.png)

![image-20210706103534882](https://cdn.liguocheng.top//uPic/image-20210706103534882.png)

#### Reads Countçš„æ³Šæ¾åˆ†å¸ƒä¼°è®¡

Reads Countåœ¨genomeä¸Šçš„åˆ†å¸ƒï¼Œå¸¸è®¤ä¸ºæ˜¯æœä»æ³Šæ¾åˆ†å¸ƒçš„ã€‚ä¸»è¦ç†ç”±æ˜¯ï¼šgenomeå¾ˆå¤§ï¼Œreadséšæœºè½åˆ°genomeä¸Šä»»æ„ä¸€ä¸ªä½ç½®æ˜¯ä¸€ä¸ªå°æ¦‚ç‡çš„äº‹æƒ…ï¼Œå› æ­¤å¯ä»¥è®¤ä¸ºæœä»æ³Šæ¾åˆ†å¸ƒã€‚

MACS2è®¤ä¸ºreads countæœä»æ³Šæ¾åˆ†å¸ƒï¼›Cuffdiff1 ä¹Ÿè®¤ä¸ºRNA-Seq geneåŒºçš„reads countæœä»æ³Šæ¾åˆ†å¸ƒã€‚

- ç¼ºç‚¹ï¼š

æ³Šæ¾åˆ†å¸ƒåªæœ‰1ä¸ªå‚æ•°Î»ï¼Œä¸”æœŸæœ›ï¼Œæ–¹å·®éƒ½æ˜¯Î»ï¼›ä½†å®é™…é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½ä¿è¯éšæœºæŠ½æ ·çš„ç»“æœå°±ç¬¦åˆæœŸæœ›å’Œæ–¹å·®ç›¸ç­‰ã€‚

#### Reads Countè´ŸäºŒé¡¹åˆ†å¸ƒä¿®æ­£

è‹¥Xæœä»è´ŸäºŒé¡¹åˆ†å¸ƒï¼Œé‚£ä¹ˆï¼š

E(X)=Î¼

Var(X)=Î¼ + Î¼2/ğ‘˜

å…¶ä¸­ï¼Œkå¸¸è¢«æˆ‘ä»¬æˆä¸ºæ•£åº¦ï¼ˆdispersionï¼‰ï¼Œé€šè¿‡æ•£åº¦kçš„ä¿®æ­£ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°è¿›è¡Œç»Ÿè®¡æ£€éªŒã€‚

ç›®å‰ï¼ŒCuffdiff2ï¼ŒDESeq2ç­‰åŸºå› å·®å¼‚è¡¨è¾¾æ£€æµ‹çš„è½¯ä»¶éƒ½å·²ç»åœ¨ä½¿ç”¨è´ŸäºŒé¡¹åˆ†å¸ƒè¿›è¡Œå‚æ•°ä¼°è®¡ã€‚

#### Lander Watermanæ›²çº¿

å‡è®¾Genomeé•¿åº¦ä¸ºGï¼›readsæµ‹åºé•¿åº¦ä¸ºLï¼›æ€»readsæ•°ç›®ä¸ºNï¼›æµ‹åºä¹˜æ•°X = LN / G

é‚£ä¹ˆåœ¨è¿›è¡Œæ‹¼è£…çš„æ—¶å€™ï¼Œå¦‚æœä¸¤æ¡readsé‡å çš„åŒºåŸŸè¶…è¿‡Tbpï¼Œæˆ–è€…æ˜¯ç”¨é‡å æ¯”a = T / Læ¥è¡¨ç¤ºï¼Œé‚£ä¹ˆèƒ½å¤Ÿæ‹¼æˆçš„contigæ•°ç›®Mæœä»Lander Watermanæ›²çº¿ï¼š

M= Nğ‘’^âˆ’(1âˆ’ğ‘)ğ‘‹^=ğº/ğ¿(Xğ‘’^âˆ’(1âˆ’ğ‘)ğ‘‹^)

## å¸¸è§è¿ç»­éšæœºåˆ†å¸ƒ

### æŒ‡æ•°åˆ†å¸ƒ

![image-20210706110219758](https://cdn.liguocheng.top//uPic/image-20210706110219758.png)

- æŒ‡æ•°åˆ†å¸ƒä¹Ÿæ— è®°å¿†æ€§ã€‚

### ä¼½é©¬åˆ†å¸ƒ

![image-20210706110353116](https://cdn.liguocheng.top//uPic/image-20210706110353116.png)

- Gammaåˆ†å¸ƒå¸¸ç”¨æ¥ä½œä¸ºæŸä¸ªäº‹ä»¶æ€»å…±å‡ºç°Næ¬¡çš„ç­‰å¾…æ—¶é—´
- Gammaåˆ†å¸ƒå¯ä»¥ç†è§£æˆè´ŸäºŒé¡¹åˆ†å¸ƒçš„è¿ç»­æ¨å¹¿ï¼›åŒç†æŒ‡æ•°åˆ†å¸ƒå¯ä»¥è®¤ä¸ºæ˜¯å‡ ä½•åˆ†å¸ƒçš„æé™æ¨å¹¿

### æ­£æ€åˆ†å¸ƒ(è¯¯å·®åˆ†å¸ƒ)

![image-20210706110702838](https://cdn.liguocheng.top//uPic/image-20210706110702838.png)



![image-20210706110825695](https://cdn.liguocheng.top//uPic/image-20210706110825695.png)

#### æ­£æ€åˆ†å¸ƒçš„3 sigma æ³•åˆ™

![image-20210706110847699](https://cdn.liguocheng.top//uPic/image-20210706110847699.png)

#### Boxplot

![YWY7KR](https://cdn.liguocheng.top//uPic/YWY7KR.jpg)

#### æ­£æ€åˆ†å¸ƒæ€§è´¨

1.æ­£æ€åˆ†å¸ƒæ˜¯è‡ªç„¶ç•Œæœ€å¸¸è§çš„ä¸€ç§åˆ†å¸ƒï¼Œä¾‹å¦‚æµ‹é‡çš„è¯¯å·®ã€ç‚®å¼¹å¼¹è½ç‚¹çš„åˆ†å¸ƒã€äººçš„ç”Ÿç†ç‰¹å¾çš„å°ºå¯¸ï¼ˆèº«é«˜ï¼Œä½“é‡ç­‰ï¼‰ã€å†œä½œç‰©çš„æ”¶è·é‡ç­‰éƒ½è¿‘ä¼¼æœä»æ­£æ€åˆ†å¸ƒã€‚

2.ä¸€èˆ¬è¯´æ¥ï¼Œè‹¥å½±å“æŸä¸€æ•°é‡æŒ‡æ ‡çš„éšæœºå› ç´ å¾ˆå¤šï¼Œè€Œæ¯ä¸ªå› ç´ æ‰€èµ·çš„ä½œç”¨ä¸å¤ªå¤§ï¼Œåˆ™è¿™ä¸ªæŒ‡æ ‡æœä»æ­£æ€åˆ†å¸ƒã€‚

3.æ­£æ€åˆ†å¸ƒå…·æœ‰è®¸å¤šè‰¯å¥½çš„æ€§è´¨ï¼Œè®¸å¤šåˆ†å¸ƒå¯ç”¨æ­£æ€åˆ†å¸ƒæ¥è¿‘ä¼¼ï¼Œå¦å¤–ä¸€äº›åˆ†å¸ƒåˆå¯ä»¥é€šè¿‡æ­£æ€åˆ†å¸ƒæ¥å¯¼å‡ºã€‚

> å¤§æ•°å®šå¾‹ï¼šéšæœºå˜é‡çš„å¹³å‡å€¼èƒ½å¤Ÿæ”¶æ•›åˆ°æœŸæœ›å€¼
>
> ä¸­å¿ƒæé™å®šç†ï¼šå¤§é‡éšæœºå˜é‡çš„åŠ å’Œä¹‹åçš„åˆ†å¸ƒåœ¨æŸäº›æ¡ä»¶ä¸‹é€¼è¿‘æ­£æ€åˆ†å¸ƒ

![KAm4Fd](https://cdn.liguocheng.top//uPic/KAm4Fd.jpg)

> æ¦‚ç‡æ˜¯é¢‘ç‡éšæ ·æœ¬è¶‹äºæ— ç©·çš„æé™
>
> æœŸæœ›æ˜¯å¹³å‡æ•°éšæ ·æœ¬è¶‹äºæ— ç©·çš„æé™

## å‡è®¾æ£€éªŒ

1. K. Pearson(å¡å°”Â·çš®å°”é€Š)

- æå‡ºæ‹Ÿåˆä¼˜åº¦æ£€éªŒ

- æ‹Ÿåˆå¡æ–¹ç»Ÿè®¡é‡çš„æé™å®šç†

2. SirRonald Aylmer Fisher(ç½—çº³å¾·Â·è‰¾å°”é»˜Â·è´¹å¸Œå°”)

- å¥³å£«å“èŒ¶

- ç°ä»£ç»Ÿè®¡å­¦çš„å¥ åŸºäºº

- Fisherçº¿æ€§åˆ¤åˆ«åˆ†æ

- æå¤§ä¼¼ç„¶ä¼°è®¡æ³•

- å®éªŒè®¾è®¡

3. Neymanand E.Pearson

- å®Œå–„å‡è®¾æ£€éªŒçš„æ­¥éª¤

### å¥³å£«å“èŒ¶

æœ‰ä¸€ä¸ªYoung ladyéå¸¸å–œæ¬¢å–èŒ¶ï¼Œç„¶åè¿˜å–œæ¬¢åœ¨èŒ¶ï¼ˆTï¼‰é‡ŒåŠ ç‰›å¥¶ï¼ˆMï¼‰ï¼ŒåŒæ—¶å·ç§°èƒ½å¤Ÿå°å‡ºæ¥æ˜¯è¿™ä¸¤è€…å…ˆååŠ å…¥çš„é¡ºåºï¼Œå³èƒ½å¤Ÿé€šè¿‡å“å°çŸ¥é“æ˜¯TMï¼ˆå…ˆåŠ èŒ¶å†åŠ å¥¶ï¼‰è¿˜æ˜¯MTï¼ˆå…ˆåŠ å¥¶å†åŠ èŒ¶ï¼‰ã€‚

Fisherè§‰å¾—ï¼Œæœ‰å¿…è¦é€šè¿‡ä¸€å®šçš„ç»Ÿè®¡å­¦æ–¹æ³•æ¥ç¡®å®šè¿™ä¸ªäº‹æƒ…æ˜¯ä¸æ˜¯çœŸå®å®¢è§‚çš„ã€‚é‚£æ€ä¹ˆæ¥åšè¿™ä»¶äº‹æƒ…å‘¢ï¼Ÿä»–å…ˆå‡†å¤‡å¥½MTï¼ŒTMå„4æ¯ï¼Œç„¶åè®©å¦¹å­ç›²å–ï¼Œæœ€åå¦¹å­ç­”å¯¹äº†8æ¯é‡Œçš„7æ¯ã€‚é‚£ä¹ˆå¥³å£«æœ‰æ²¡æœ‰è¯´è°ï¼Ÿ

å‡è®¾è¿™ä½ladyæ˜¯éšæœºè’™çš„ï¼Œé‚£ä¹ˆå¯ä»¥è®¡ç®—ï¼š

![image-20210706142235247](https://cdn.liguocheng.top//uPic/image-20210706142235247.png)

é‚£ä¹ˆå‡ºç°çŒœå¯¹7æ¯åŠ7æ¯ä»¥ä¸Šçš„æ¦‚ç‡ä¸ºï¼š

![image-20210706142305755](https://cdn.liguocheng.top//uPic/image-20210706142305755.png)

ç”±è®¡ç®—å¯å¾—ï¼Œå¦‚æœæ˜¯éšæœºçŒœçš„é‚£ä¹ˆæ¦‚ç‡ä¼šå¾ˆå°ï¼Œå•æ¬¡æµ‹è¯•è¿™ç§å°æ¦‚ç‡äº‹ä»¶ä¸å¤ªå¯èƒ½å‘ç”Ÿï¼Œå› æ­¤Fisherè§‰å¾—å¥³å£«æ²¡æœ‰è¯´è°ã€‚

> è¿™ä¸ªå°æ¦‚ç‡çš„æ ‡å‡†æ€ä¹ˆç¡®å®šï¼Ÿ
>
> Fisherè€çˆ·å­è‡ªå·±ç¡®å®šäº†0.05è¿™ä¸ªæ•°å€¼ã€‚

![ç»Ÿè®¡æ–¹æ³•](https://cdn.liguocheng.top//uPic/%E7%BB%9F%E8%AE%A1%E6%96%B9%E6%B3%95.png)

### ä»€ä¹ˆæ˜¯å‡è®¾æ£€éªŒ

- ä»€ä¹ˆæ˜¯å‡è®¾ï¼Ÿ

å‡è®¾å¯ä»¥æ˜¯å¯¹æ€»ä½“çš„ä¸€ç§çœ‹æ³•

æ¯”å¦‚ï¼šFisherè®¤ä¸ºå¥³å£«çŒœMTå’ŒTMæ˜¯éšæœºï¼Œé€šè¿‡è¿™ä¸ªå‡è®¾æˆ‘ä»¬å¯ä»¥ç¡®å®šæ€»ä½“çš„ä¸€äº›å‚æ•°ã€‚

- ä»€ä¹ˆæ˜¯æ£€éªŒï¼Ÿ

å¯¹åšå‡ºçš„å‡è®¾ï¼Œåˆ©ç”¨æ ·æœ¬ä¿¡æ¯æ¥åˆ¤æ–­åŸå‡è®¾æ˜¯å¦æˆç«‹ã€‚

ä¸€èˆ¬è®¤ä¸ºå°æ¦‚ç‡äº‹ä»¶åœ¨å•æ¬¡å®éªŒä¸å‘ç”Ÿã€‚

#### å‡è®¾æ£€éªŒçš„ä¸€èˆ¬æ€æƒ³

- æ€»ä½“å’ŒæŠ½æ ·

Î¼1ä¸Î¼0çš„å·®è·å¾ˆå°ï¼Œå¯èƒ½æ˜¯æŠ½æ ·çš„è¯¯å·®å¯¼è‡´çš„å·®å¼‚ï¼›

Î¼2ä¸Î¼0çš„å·®è·å¾ˆå¤§ï¼Œæ˜¯ä¸ªå°æ¦‚ç‡äº‹ä»¶ï¼Œå› æ­¤è®¤ä¸ºÎ¼2å¯èƒ½æ˜¯æ¥è‡ªä¸åŒæ€»ä½“

#### å‡è®¾æ£€éªŒçš„ä¸€èˆ¬æ­¥éª¤

1. æå‡ºåŸå‡è®¾H0å’Œå¤‡æ‹©å‡è®¾H1

2. ç¡®å®šé€‚å½“çš„æ£€éªŒç»Ÿè®¡é‡

3. è®¡ç®—å‡ºæŠ½æ ·ç»“æœçš„P Value

4. å¦‚æœP Valueå¾ˆå°ï¼ˆä¸€èˆ¬cutoff=0.01æˆ–0.05ï¼‰ï¼Œåˆ™æ‹’ç»H0æ¥å—H1

### Pvalue è®¡ç®—

- PValueæ˜¯è§‚å¯Ÿåˆ°æŠ½æ ·ç»“æœçš„æˆ–è€…æ˜¯æ¯”æŠ½æ ·ç»“æœæ›´æç«¯çš„æ¦‚ç‡

Rä¸­è®¡ç®— Pvalueçš„å‡½æ•°ï¼š

![j1S5Cq](https://cdn.liguocheng.top//uPic/j1S5Cq.png)

> p for "probability", the cumulative distribution function (c. d. f.)
>
> q for "quantile", the inverse c. d. f.
>
> d for "density", the density function (p. f. or p. d. f.)
>
> r for "random", a random variable having the specified distribution
>
> pä»£è¡¨æ¦‚ç‡è®¡ç®—
>
> qä»£è¡¨åˆ†ä½æ•°è®¡ç®—
>
> dä»£è¡¨æ¦‚ç‡å¯†åº¦å‡½æ•°
>
> rä»£è¡¨å–å¯¹åº”åˆ†å¸ƒçš„éšæœºæ•°

```R
# norm 
# q,p,d,r
# æ¦‚ç‡
pnorm(-1.96,mean = 0,sd= 1)
# åˆ†ä½æ•°
qnorm(0.99,mean = 0,sd = 1) 
# æ¦‚ç‡å¯†åº¦å‡½æ•°
plot(dnorm(seq(-10,10,length.out = 1000),mean = 0,sd = 1))
# éšæœºæ­£æ€åˆ†å¸ƒ
set.seed(2021)
rnorm(10,mean = 5,sd = 2)
```

### ç”Ÿä¿¡ä¸­çš„ä¾‹å­

BS-Seqä¹Ÿå«äºšç¡«é…¸æ°¢ç›æµ‹åºæŠ€æœ¯æ˜¯ä¸€ç§èƒ½å¤Ÿè¿›è¡Œå…¨åŸºå› ç»„5mCä½ç‚¹æ£€æµ‹çš„æŠ€æœ¯ã€‚

![LfrPPt](https://cdn.liguocheng.top//uPic/LfrPPt.jpg)

å½“åŸºå› ç»„åºåˆ—ä¸­å­˜åœ¨æœªç”²åŸºåŒ–çš„Cçš„æ—¶å€™ï¼Œç»è¿‡äºšç¡«é…¸æ°¢ç›çš„DNAä¼šå‘ç”Ÿè„±æ°¨ååº”ï¼Œç”±Cå˜æˆdUï¼Œç„¶ååœ¨æµ‹åºçš„è¿‡ç¨‹ä¸­ä¼šè¯»æˆTï¼›è€Œ5mCåˆ™ä¸ä¼šå‘ç”Ÿè„±æ°¨ååº”ï¼Œåœ¨æµ‹åºç»“æœä¸­ä¼šè¢«è®°å½•æˆC

å·²çŸ¥åœ¨æŸæ¬¡æµ‹åºä¸­ï¼Œå…¨åŸºå› ç»„å¹³å‡çªå˜ç‡ä¸º0.003ï¼ŒæŸä¸ªä½ç‚¹ä¸­æµ‹åˆ°å¸¦æœ‰Cçš„reads 10æ¡ï¼Œå¸¦æœ‰Tçš„reads 3æ¡ï¼Œé‚£ä¹ˆè¯¥ä½ç‚¹æ˜¯å¦ä¸ºä¸€ä¸ªç”²åŸºåŒ–ä½ç‚¹ï¼Ÿ

å¯ä»¥ä½¿ç”¨äºŒé¡¹åˆ†å¸ƒè®¡ç®—pvalueï¼Œå…¶ä¸­n=13ï¼Œp=0.003

![image-20210706145949416](https://cdn.liguocheng.top//uPic/image-20210706145949416.png)

åœ¨ç”Ÿä¿¡åˆ†æä¸­ï¼Œç»å¸¸ä¼šå‡ºç°peak-callingçš„è¿‡ç¨‹ï¼Œæ¯”å¦‚ChIP-Seqã€‚

![image-20210706150218059](https://cdn.liguocheng.top//uPic/image-20210706150218059.png)

ç›®å‰ChIP-Seq peak-callingæœ€å¸¸ä½¿ç”¨çš„è½¯ä»¶æ˜¯MACS2ï¼ŒMACS2ä¸­è®¤ä¸ºreads countåœ¨åŸºå› ç»„æŸä¸ªåŒºåŸŸçš„åˆ†å¸ƒæœä»æ³Šæ¾åˆ†å¸ƒï¼Œé‚£ä¹ˆï¼Œå‡è®¾ä½ æœ‰Inputï¼ŒChIP_PullDown2ä¸ªæ ·æœ¬ï¼Œè¯·é—®ï¼š

1. æ€ä¹ˆå¤§æ¦‚ä¼°è®¡æŸä¸€æ®µåŒºåŸŸçš„Possionåˆ†å¸ƒçš„å‚æ•°?

2. å‡è®¾å·²ç»ä¼°ç®—å‡ºlambda = 5ï¼Œå¦‚æœä¸€æ®µåŒºåŸŸå†…å‡ºç°äº†20æ¡reads é‚£ä¹ˆpvalueåº”è¯¥æ˜¯å¤šå°‘ï¼Ÿ

![image-20210706150332319](https://cdn.liguocheng.top//uPic/image-20210706150332319.png)

```R
# methylation call 
binom.test(x = 3,n = 13,p = 0.003)

# Chip-seq call
ppois(q = 20,lambda = 5)
1 - ppois(q = 20,lambda = 5)
```

## ç»Ÿè®¡åŠŸæ•ˆä¸å‡è®¾æ£€éªŒçš„ä¸¤ç±»é”™è¯¯

### ä¸¤ç±»é”™è¯¯

ç¬¬ä¸€ç±»é”™è¯¯Î±ï¼šå‡é˜³æ€§ï¼›çº³ä¼ª

ç¬¬äºŒç±»é”™è¯¯Î²ï¼šå‡é˜´æ€§ï¼›å»çœŸ

### ç»Ÿè®¡åŠŸæ•ˆ

> Î±å®¹æ˜“æ§åˆ¶ï¼Œä½†Î²ä¸å®¹æ˜“ç¡®å®š
>
> æé«˜ç»Ÿè®¡åŠŸæ•ˆï¼š
>
> åŠ å¤§æ ·æœ¬é‡å’Œæ›´æ”¹ç»Ÿè®¡æ–¹æ³•
>
> å½“æ ·æœ¬é‡ç¡®å®šæ—¶ï¼Œéœ€è¦trade-off

- ç™Œç—‡è¯Šæ–­æ—¶ï¼Œéœ€è¦é™ä½Î²ï¼Œå³æé«˜Î±(é™ä½å‡é˜´æ€§)

- Call peakæ—¶ï¼Œéœ€è¦é™ä½Î±ï¼Œå³æé«˜Î²(é™ä½å‡é˜³æ€§)

![udEQ9m](https://cdn.liguocheng.top//uPic/udEQ9m.png)

### ä½¿ç”¨P valueå¸¸è§çš„é”™è¯¯

1. åœ¨ä»»ä½•æ—¶å€™éƒ½ä»¥0.05æˆ–è€…0.01ä¸ºé‡‘æ ‡å‡†

> æœ‰äº›ç»Ÿè®¡æ£€éªŒæ–¹æ³•éå¸¸â€œæ•æ„Ÿâ€å®¹æ˜“å‡ºç°éå¸¸å°çš„P Value

2. è®¾å®šP Valueé˜ˆå€¼æ—¶å¿½ç•¥äº†ç¬¬2ç±»é”™è¯¯çš„çŠ¯é”™å¯èƒ½

> å¦‚æœH1æ˜¯ä¸€ç§å¾ˆä¸¥é‡çš„ç–¾ç—…ï¼Œé‚£ä¹ˆæœ‰çš„æ—¶å€™æˆ‘ä»¬åº”è¯¥æé«˜æ˜¾è‘—æ°´å¹³Î±ï¼Œä»è€Œé™ä½Î²

3. åœ¨è®¡ç®—P Valueçš„è¿‡ç¨‹ä¸­ï¼Œå¿½ç•¥äº†ä½¿ç”¨å‡è®¾æ£€éªŒçš„åŸºæœ¬æ¡ä»¶

> Tæ£€éªŒéœ€è¦æ ·æœ¬ç¬¦åˆæ­£æ€åˆ†å¸ƒï¼Œä¸”æ–¹å·®é½æ€§ã€‚

4. åœ¨ä½¿ç”¨P Valueçš„æ—¶å€™ï¼Œå¿½ç•¥äº†å‡è®¾æ£€éªŒåŸå‡è®¾

> å›å½’åˆ†æä¸­çš„åŸå‡è®¾æ˜¯ï¼Œä¸¤ä¸ªå˜é‡æ²¡æœ‰ç›¸å…³å…³ç³»ï¼Œä¸èƒ½ç”¨P valueçš„æ•°å€¼åˆ¤æ–­ä¸¤ä¸ªå˜é‡ç›¸å…³å…³ç³»çš„å¤§å°ã€‚

## T test

![æ€»ä½“æ£€éªŒ](https://cdn.liguocheng.top//uPic/%E6%80%BB%E4%BD%93%E6%A3%80%E9%AA%8C.png)

### Z scoreå’Œ Z å˜æ¢

å¯¹ä»»æ„ä¸€ä¸ªå˜é‡Xåšä¸‹åˆ—å˜åŒ–å‡å¾—å‡ºçš„å‡ä¸ºZ-Scoreï¼Œå¦‚æœXæœä»æ­£æ€åˆ†å¸ƒï¼Œé‚£ä¹ˆZ~N(0,1)ï¼Œç¬¦åˆæ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚

![wVUJuX](https://cdn.liguocheng.top//uPic/wVUJuX.png)æŸæœºåºŠå‚åŠ å·¥ä¸€ç§é›¶ä»¶ï¼Œæ ¹æ®ç»éªŒçŸ¥é“ï¼Œè¯¥å‚åŠ å·¥é›¶ä»¶çš„æ¤­åœ†åº¦è¿‘ä¼¼æœä»æ­£æ€åˆ†å¸ƒï¼Œå…¶æ€»ä½“å‡å€¼ä¸º0.081mmï¼Œæ€»ä½“æ ‡å‡†å·®ä¸º0.025 ã€‚ä»Šæ¢ä¸€ç§æ–°æœºåºŠè¿›è¡ŒåŠ å·¥ï¼ŒæŠ½å–n=200ä¸ªé›¶ä»¶è¿›è¡Œæ£€éªŒï¼Œå¾—åˆ°çš„æ¤­åœ†åº¦ä¸º0.076mmã€‚è¯•é—®æ–°æœºåºŠåŠ å·¥é›¶ä»¶çš„æ¤­åœ†åº¦çš„å‡å€¼ä¸ä»¥å‰æœ‰æ— æ˜¾è‘—å·®å¼‚ï¼Ÿï¼ˆÎ±ï¼0.05)

![f1874Q](https://cdn.liguocheng.top//uPic/f1874Q.png)

-2.83è½åœ¨-1.96å·¦ä¾§ï¼Œä¸ºå°æ¦‚ç‡äº‹ä»¶ï¼Œæ‹’ç»åŸå‡è®¾ï¼Œæ–°æœºåºŠåŠ å·¥é›¶ä»¶çš„æ¤­åœ†åº¦çš„å‡å€¼ä¸ä»¥å‰æœ‰æ˜¾è‘—å·®å¼‚ã€‚

### ä¸ºä»€ä¹ˆæœ‰äº†Z testè¿˜è¦ t test ï¼Ÿ

ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å¾ˆéš¾è·å¾—æ€»ä½“æ–¹å·®ï¼Œå¾€å¾€æƒ³é€šè¿‡æ ·æœ¬æ–¹å·®ä»£æ›¿æ€»ä½“æ–¹å·®ã€‚

å½“æ ·æœ¬é‡å¾ˆå¤§æ—¶ï¼Œnå¤§äº50ï¼Œè®¤ä¸ºæ˜¯å¤§æ ·æœ¬ï¼Œç¬¦åˆæ­£æ€åˆ†å¸ƒï¼Œå¯ä»¥ç”¨Z testã€‚

ä½†å½“æ ·æœ¬é‡å¾ˆå°æ—¶ï¼Œè®¤ä¸ºæ ·æœ¬ç¬¦åˆè‡ªç”±åº¦(df)ä¸º(n - 1)çš„tåˆ†å¸ƒã€‚

![4a5zN6](https://cdn.liguocheng.top//uPic/4a5zN6.png)

### T testçš„å››ç§å½¢å¼

1. æœ‰1ç»„è¯•éªŒæ ·æœ¬æ•°æ®ï¼Œä¸å·²çŸ¥æ ‡å‡†å‡å€¼ä½œæ¯”è¾ƒ

å·²çŸ¥æŸä¸ªåŸºå› Aåœ¨äººç¾¤ä¸­çš„FPKMç¨³å®šåœ¨15å·¦å³ï¼Œç°æµ‹é‡5ä¸ªç—…äººçš„FPKMä¸ºï¼š13.1ï¼Œ16.2ï¼Œ14.9ï¼Œ15.8ï¼Œ17.7ã€‚è¯•åˆ†æç—…äººè¯¥åŸºå› Aæœ‰æ²¡æœ‰æ˜¾è‘—å‡é«˜ï¼Ÿ

```R
# 1. compare with mu
res = c(13.1, 16.2, 14.9, 15.8, 17.7)
t.test(res,mu = 15,alternative = "greater")

One Sample t-test

data:  res
t = 0.71114, df = 4, p-value = 0.2581
alternative hypothesis: true mean is greater than 15
95 percent confidence interval:
 13.9212     Inf
sample estimates:
mean of x 
    15.54 
```



2. 2ç»„ç‹¬ç«‹éšæœºè¯•éªŒç»“æœï¼Œåœ¨æ–¹å·®ç›¸ç­‰æ—¶ä½œæ¯”è¾ƒ

> åœ¨ä¸€æ¬¡ç»†èƒå®éªŒä¸­ï¼Œctrlæ ·æœ¬çš„geneB FPKMä¸º ï¼š12.33,7.56,11.47 ,9.82 ,9.14
>
> ç»è¿‡ä½æ°§å¤„ç†åçš„åŸºå›  FPKMä¸ºï¼š10.41,14.82,14.13,15.81,13.62
>
> åˆ†æåŸºå› Båœ¨ç»è¿‡ä½æ°§å¤„ç†åè¡¨è¾¾é‡æœ‰æ— æ˜¾è‘—å˜åŒ–ï¼Ÿ

```R
# 2. compare two sample 
geneB.ctrl = c(12.33,7.56,11.47 ,9.82 ,9.14)
geneB.deoxy = c(10.41,14.82,14.13,15.81,13.62)
t.test(geneB.ctrl,geneB.deoxy)

Welch Two Sample t-test

data:  geneB.ctrl and geneB.deoxy
t = -2.9671, df = 7.9519, p-value = 0.01807
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -6.5679755 -0.8200245
sample estimates:
mean of x mean of y 
   10.064    13.758 
```



3. é…å¯¹æ ·æœ¬çš„å‡å€¼æ¯”è¾ƒ

   > - æ¯”å¦‚åŒç»„å®éªŒæ ·æœ¬çš„å‰åè¿›è¡Œæ¯”è¾ƒ
   >
   > - ç›¸å½“äºä¸¤ä¸ªæ•°å€¼åšå·®ï¼Œç„¶åå†è¿›è¡Œä¸æ•°å€¼0çš„æ¯”è¾ƒ

ä¸€ä¸ªä»¥å‡è‚¥ä¸ºä¸»è¦ç›®æ ‡çš„å¥ç¾ä¿±ä¹éƒ¨å£°ç§°ï¼Œå‚åŠ å…¶è®­ç»ƒç­è‡³å°‘å¯ä»¥ä½¿å‡è‚¥è€…å¹³å‡ä½“é‡å‡é‡8.5å…¬æ–¤ä»¥ä¸Šã€‚ä¸ºäº†éªŒè¯è¯¥å®£ç§°æ˜¯å¦å¯ä¿¡ï¼Œè°ƒæŸ¥äººå‘˜éšæœºæŠ½å–äº†10åå‚åŠ è€…ï¼Œå¾—åˆ°ä»–ä»¬çš„ä½“é‡è®°å½•å¦‚ä¸‹è¡¨ï¼š

![xiL6Xt](https://cdn.liguocheng.top//uPic/xiL6Xt.png)

![5GGsKy](https://cdn.liguocheng.top//uPic/5GGsKy.png)

åˆ†åˆ«è®¡ç®—æ ·æœ¬å·®å€¼çš„å‡å€¼å’Œæ ·æœ¬å·®å€¼çš„æ ‡å‡†å·®ï¼Œå†ä¸0ä½œæ¯”è¾ƒã€‚

![qw5Js8](https://cdn.liguocheng.top//uPic/qw5Js8.png)

```R
# 3. paried t-test 
before.fitness = c(94.5,101,110,103.5,97,88.5,96.5,101,104,116.5)
after.fitness = c(85,89.5,101.5,96,86,80.5,87,93.5,93,102)
after.fitness.fix = after.fitness + 8.5
## è®¡ç®—è®­ç»ƒå‰åçš„ä½“é‡å·®å€¼æ˜¯å¦æ˜¾è‘—å¤§äº8.5
t.test(before.fitness,after.fitness.fix,paired = T,alternative = "greater")

Paired t-test

data:  before.fitness and after.fitness.fix
t = 1.9413, df = 9, p-value = 0.04207
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 0.07521379        Inf
sample estimates:
mean of the differences 
                   1.35 
```

4. 2ç»„ç‹¬ç«‹éšæœºè¯•éªŒç»“æœï¼Œåœ¨æ–¹å·®ä¸ç›¸ç­‰çš„æƒ…å†µä¸‹ä½œæ¯”è¾ƒ

> åœ¨ä¸€æ¬¡ç»†èƒå®éªŒä¸­ï¼Œctrlæ ·æœ¬çš„geneB FPKMä¸ºï¼š16.46,13.56,15.05,12.76,11.88
>
> ç»è¿‡ä½æ°§å¤„ç†åçš„åŸºå›  FPKMä¸ºï¼š4.59,13.65,22.66,18.02,7.52
>
> åˆ†æåŸºå› Båœ¨ç»è¿‡ä½æ°§å¤„ç†åè¡¨è¾¾é‡æœ‰æ— æ˜¾è‘—å˜åŒ–ï¼Ÿ

- é¦–æ¬¡åº”è¯¥ä½¿ç”¨Fæ£€éªŒæ£€æŸ¥æ–¹å·®æ˜¯å¦ç›¸ç­‰ï¼Œåœ¨æ–¹å·®ä¸ç›¸ç­‰çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥ä½¿ç”¨t'æ£€éªŒæˆ–è€…Wilcoxç§©å’Œæ£€éªŒã€‚

```R
# 4. compare two sample
geneB.ctrl = c(16.46,13.56,15.05,12.76,11.88)
geneB.deoxy = c(4.59,13.65,22.66,18.02,7.52)

# test var 
var.test(geneB.ctrl,geneB.deoxy)

F test to compare two variances

data:  geneB.ctrl and geneB.deoxy
F = 0.060939, num df = 4, denom df = 4, p-value = 0.01904
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.006344836 0.585292073
sample estimates:
ratio of variances 
        0.06093917
# t-test 
t.test(geneB.ctrl,geneB.deoxy,var.equal = F)

# t = 0.19175, df = 4.4857, p-value = 0.8563
# wilcox test 
wilcox.test(geneB.ctrl,geneB.deoxy)

Wilcoxon rank sum exact test

data:  geneB.ctrl and geneB.deoxy
W = 12, p-value = 1
alternative hypothesis: true location shift is not equal to 0
```

### ä½¿ç”¨ T testéœ€è¦æ³¨æ„

æœ‰ä¸¤æ‰¹å®éªŒç»“æœï¼Œéœ€è¦æ¯”è¾ƒæ˜¯å¦æœ‰å·®å¼‚

- ä¸¤ä¸ªæ ·æœ¬æ˜¯ç‹¬ç«‹çš„éšæœºæ ·æœ¬

- ä¸¤ä¸ªæ€»ä½“éƒ½æ˜¯æ­£æ€åˆ†å¸ƒ

- ä¸¤ä¸ªæ€»ä½“æ–¹å·®æœªçŸ¥ä½†ç›¸ç­‰

é…å¯¹T-test

- ä¸¤ä¸ªæ€»ä½“éƒ½æœä»æ­£æ€åˆ†å¸ƒ

- å¦‚æœä¸æœä»æ­£æ€åˆ†å¸ƒï¼Œå¯ç”¨æ­£æ€åˆ†å¸ƒæ¥è¿‘ä¼¼(n1 > 30, n2 >30 )

## åˆ—è”è¡¨æ£€éªŒ

### K. Pearson ä¸æ‹Ÿåˆä¼˜åº¦æ£€éªŒ

> å¦‚æœå·²çŸ¥ä¸€ä¸ªåˆ†å¸ƒF(x)ï¼Œè·å¾—äº†ä¸€ä¸ªæŠ½æ ·ç»“æœXï¼Œé‚£ä¹ˆæ€ä¹ˆåˆ¤æ–­Xæ˜¯ä¸æ˜¯æœä»F(x)åˆ†å¸ƒï¼Ÿ

H0: Xå…·æœ‰åˆ†å¸ƒF

H1: Xä¸å…·æœ‰åˆ†å¸ƒF

å°†(âˆ’âˆ,+âˆ)åˆ†æˆmä¸ªåŒºé—´ï¼š

ğ¼1=(âˆ’âˆ,ğ‘1), ğ¼2=[ğ‘1,ğ‘2), ğ¼3=[ğ‘2,ğ‘3) â€¦ ğ¼ğ‘š=[ğ‘ğ‘šâˆ’1,+âˆ)

å¯¹åº”åŒºé—´çš„ç†è®ºæ¦‚ç‡åˆ†å¸ƒåˆ†åˆ«ä¸ºï¼š

ğ‘1,ğ‘2,ğ‘3,â€¦ğ‘ğ‘š

è®°ğ‘›ğ‘–ä¸ºğ‘‹1,ğ‘‹2,ğ‘‹3â€¦ğ‘‹ğ‘šä¸­è½åœ¨åŒºé—´ğ¼ğ‘–ä¸­çš„è§‚æµ‹ä¸ªæ•°ï¼Œé‚£ä¹ˆåœ¨åŸå‡è®¾æˆç«‹çš„æƒ…å†µä¸‹ï¼Œ(ğ‘›ğ‘–-ğ‘›ğ‘ğ‘–)çš„å·®å€¼åº”è¯¥ä¸ä¼šå¾ˆå¤§ã€‚

*K.Pearson* å‘ç°è‹¥åŸå‡è®¾æˆç«‹çš„æƒ…å†µä¸‹ï¼Œå½“nè¶‹å‘æ— ç©·å¤§åˆ™ä¼šæœ‰ä¸‹é¢çš„å…³ç³»å¼ï¼š

![jkCHB3](https://cdn.liguocheng.top//uPic/jkCHB3.png)

å› æ­¤ï¼Œå½“åœ¨å¤§æ ·æœ¬æ°´å¹³ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºç»Ÿè®¡é‡Kè¿‘ä¼¼æœä»å¡æ–¹åˆ†å¸ƒï¼Œä»è€Œè¿›è¡Œå¡æ–¹æ£€éªŒã€‚

- å¡æ–¹åˆ†å¸ƒä¸è‡ªç”±åº¦æœ‰å…³

![image-20210706215350943](https://cdn.liguocheng.top//uPic/image-20210706215350943.png)

### å¡æ–¹æ£€éªŒåº”ç”¨

1. å¤§éº¦çš„æ‚äº¤åä»£æ— èŠ’ï¼šé•¿èŠ’ï¼šçŸ­èŠ’= 9:3:4ï¼Œå®é™…è§‚æµ‹æ•°æ®ä¸º335:125:160.è¯·é—®è¯•éªŒç»“æœæ˜¯å¦ç¬¦åˆç†è®ºå‡è®¾ï¼Ÿ

> ç›¸å½“äºæ˜¯ä¸ç†è®ºåˆ†å¸ƒçš„æ¦‚ç‡è¿›è¡Œæ¯”è¾ƒï¼Œè¿˜æ˜¯chisq.testå‡½æ•°ï¼Œä¸è¿‡éœ€è¦ä½¿ç”¨på‚æ•°ã€‚

```R
# chisq test 2 
ratio_vec = c(335,125,160)
prob_vec = c(9,3,4) / 16
chisq.test(ratio_vec,p = prob_vec)

Chi-squared test for given probabilities

data:  ratio_vec
X-squared = 1.362, df = 2, p-value = 0.5061
# æ— æ³•æ‹’ç»åŸå‡è®¾ï¼Œè¯•éªŒç»“æœç¬¦åˆç†è®ºå‡è®¾ã€‚
```

2. åœ¨GOã€KEGGç­‰å¯Œé›†åˆ†æä¸­ç»å¸¸ä¼šé‡åˆ°æ£€éªŒé—®é¢˜ï¼š

ä¸€æ¬¡RNA-Seqä¸­ï¼Œå·®å¼‚è¡¨è¾¾åŸºå› æœ‰255ä¸ªï¼Œå…¶ä¸­55ä¸ªåŸºå› èƒ½å¤Ÿè¢«æ³¨é‡Šæˆé€šè·¯Aï¼Œè¯·é—®å·®å¼‚æ˜¾è‘—çš„åŸºå› æ˜¯å¦åœ¨é€šè·¯Aæœ‰å¯Œé›†ï¼Ÿ

![UZErva](https://cdn.liguocheng.top//uPic/UZErva.png)

å¦‚æœä¸¤è€…æ²¡æœ‰å·®å¼‚ï¼Œé‚£ä¹ˆä¸¤è€…åœ¨é€šè·¯Aä¸ä¸åœ¨é€šè·¯Açš„åŸºå› æ•°ç›®çš„æ¯”å€¼åº”è¯¥ç›¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´

- ç†è®ºä¸Šåœ¨é€šè·¯Aä¸­çš„åŸºå› æ¦‚ç‡= ï¼ˆ55 + 200ï¼‰/ ï¼ˆ255 + 20800ï¼‰= 0.012111

- ç†è®ºä¸Šä¸åœ¨é€šè·¯Aä¸­çš„æ¦‚ç‡= 1 -0.012111

- å› æ­¤å¯ä»¥è®¡ç®—åˆ—è”è¡¨ä¸­å¯¹åº”ä½ç½®åœ¨â€œæ²¡æœ‰å·®å¼‚â€è¿™ä¸ªå‡è®¾ä¸‹çš„ç†è®ºæ•°å€¼T

> å·®å¼‚è¡¨è¾¾åŸºå› åœ¨é€šè·¯A

T~11~= (55 + 200) * 0.012111= 3.088

> å·®å¼‚è¡¨è¾¾åŸºå› ä¸åœ¨é€šè·¯A

T~12~= (55 + 200) * (1 -0.012111) = 251.912 

T~21~= (200 + 19800) * 0.012111 = 251.912

T~22~= (200 + 19800) * (1 -0.012111) = 20548.088 

![6ChveX](https://cdn.liguocheng.top//uPic/6ChveX.png)

- è‡ªç”±åº¦= (R-1) * (C-1); å…¶ä¸­Rä¸ºè¡Œæ•°ï¼ŒCä¸ºåˆ—æ•°

ç»Ÿè®¡é‡ğ¾=(55âˆ’3)^2/3 + (200âˆ’252)^2/252 + (200âˆ’252)^2/252 + (19800âˆ’20548)^2/20548

```R
# chisq test 3
test_mat = matrix(c(55,200,200,19800),ncol = 2,nrow = 2)
chisq.test(test_mat)

Pearson's Chi-squared test with Yates' continuity correction

data:  test_mat
X-squared = 840.46, df = 1, p-value < 2.2e-16

Warning message:
In chisq.test(test_mat) : Chi-squared approximation may be incorrect
```

åªæœ‰å½“åœ¨å¤§æ ·æœ¬æ°´å¹³ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºç»Ÿè®¡é‡Kè¿‘ä¼¼æœä»å¡æ–¹åˆ†å¸ƒï¼Œå¦åˆ™ä½¿ç”¨Fisherâ€™s exact test

- å½“è¡¨æ ¼ä¸­ç†è®ºé¢‘æ•°å°äº5ï¼Œæˆ–è€…æ˜¯åŠ å’Œæ ·æœ¬æ€»æ•°nå°äº40æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨Fisherç²¾ç¡®æ£€éªŒï¼Œè€Œä¸æ˜¯å¡æ–¹æ£€éªŒã€‚

### Fisherâ€™s exact test

Fisherç²¾ç¡®æ£€éªŒæœ¬è´¨ä¸Šæ˜¯è¶…å‡ ä½•åˆ†å¸ƒæ£€éªŒï¼Œæœ¬é—®é¢˜å¯ä»¥ç†è§£æˆï¼š

- åœ¨21055ä¸ªåŸºå› ä¸­ï¼Œæœ‰255ä¸ªåœ¨é€šè·¯Aï¼Œ20800ä¸åœ¨é€šè·¯Aï¼›

- éšæœºæŠ½å–255ä¸ªåŸºå› ï¼Œè§‚å¯Ÿåˆ°åœ¨é€šè·¯Aä¸­çš„åŸºå› ä¸ªæ•°ä¸º55ä¸ªï¼›

- é‚£ä¹ˆå‡ºç°è¯¥æŠ½æ ·ç»“æœï¼Œæˆ–è€…æ˜¯æ›´ç½•è§æƒ…å†µçš„æ¦‚ç‡å°±æ˜¯æœ€ç»ˆçš„P Value

```R
# fisher test 
test_mat = matrix(c(55,200,200,19800),ncol = 2,nrow = 2)
fisher.test(test_mat)

Fisher's Exact Test for Count Data

data:  test_mat
p-value < 2.2e-16
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 19.19368 38.12413
sample estimates:
odds ratio 
  27.19726 
```

### åˆ—è”è¡¨æ£€éªŒæ€»ç»“

- å¡æ–¹æ£€éªŒä»¥å¡æ–¹åˆ†å¸ƒå’Œæ‹Ÿåˆä¼˜åº¦æ£€éªŒä¸ºç†è®ºä¾æ®ï¼Œä½¿ç”¨èŒƒå›´éå¸¸å¹¿æ³›ï¼Œå¤§å®¶å¯ä»¥çµæ´»è¿ç”¨ï¼›

- å½“åº”ç”¨å¡æ–¹æ£€éªŒæ—¶ï¼Œç†è®ºé¢‘æ•°å°äº5ï¼Œæˆ–è€…æ˜¯è¯•éªŒæ€»æ•°å°äº40æ—¶ï¼Œåº”å½“ä½¿ç”¨Fisherç²¾ç¡®æ£€éªŒï¼›

- ç”Ÿç‰©ä¿¡æ¯å­¦ä¸­æ¯”è¾ƒå¸¸è§çš„åˆ—è”è¡¨æ£€éªŒï¼š

  å¯Œé›†åˆ†æï¼Œå¦‚GOï¼ŒKEGGï¼ŒDOå¯Œé›†åˆ†æç­‰ï¼›

  åˆ¤æ–­æŸä½ç‚¹æ˜¯å¦ä¸ºçªå˜ä½ç‚¹ï¼›

## å¤šé‡å‡è®¾æ£€éªŒçš„çŸ«æ­£

### P value çš„çŸ«æ­£

å½“æœ‰è¶…è¿‡2æ¬¡æ£€éªŒä»¥ä¸Šçš„æƒ…å†µæ—¶ï¼Œå°±è¦åšå¤šé‡å‡è®¾æ£€éªŒæ ¡æ­£ã€‚

> è™½ç„¶æˆ‘ä»¬ä¼šæ§åˆ¶ç¬¬1ç±»é”™è¯¯Î±çš„çŠ¯é”™æ¦‚ç‡åœ¨ä¸€ä¸ªå¾ˆå°çš„èŒƒå›´å†…ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨è¿›è¡Œå¤šæ¬¡æ£€éªŒçš„è¿‡ç¨‹ä¸­ï¼Œä¸å¯é¿å…åœ°ä¼šç¢°åˆ°ç¬¬1ç±»é”™è¯¯ã€‚
>
> å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¯¹P Valueè¿›è¡Œä¸€ä¸ªæ”¾å¤§ï¼Œä»è€Œæ›´åŠ ä¸¥æ ¼åœ°ç­›é€‰æˆ‘ä»¬æ£€éªŒç»“æœã€‚

- å¯¹äºBonferroniæ ¡æ­£ï¼Œæ˜¯å°†p-valueæ‰©å¤§nå€ä½œä¸ºæ ¡æ­£ç»“æœï¼Œä½†å¾€å¾€å¤ªè¿‡ä¸¥æ ¼ï¼›

- ç›®å‰æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯BH(Benjaminiand Hochberg)æ ¡æ­£æ–¹æ³•ï¼Œå…·ä½“æ“ä½œï¼š

å¯¹æ¯ä¸ªpvalueåšæ ¡æ­£ï¼Œè½¬æ¢ä¸ºq-valueï¼š

q value = p value * n / rankï¼Œå…¶ä¸­rankæ˜¯æŒ‡p valueä»å°åˆ°å¤§æ’åºåçš„æ¬¡åºï¼›

q value æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºFDRï¼ˆFalse Discover Rateï¼‰ï¼Œä»æ•°å­¦ä¸Šå¯ä»¥ä¸¥æ ¼è¯æ˜ï¼Œç»è¿‡BHçŸ«æ­£åçš„qvalueå¯ä»¥ï¼Œå¦‚æœé€‰æ‹©Î±ä½œä¸ºqvalueçš„é˜ˆå€¼ï¼Œé‚£ä¹ˆFDRä¸ä¼šè¶…è¿‡Î±

![R1rPCC](https://cdn.liguocheng.top//uPic/R1rPCC.jpg)

```R
# pvalue adj
set.seed(2021)

test_pvalue = abs(rnorm(20,mean = 0.01,sd=0.05))
test_pvalue

[1] 0.013051940 0.065686970 0.027708780 0.031860281 0.064468110 0.021540743 0.037773877 0.067085612 0.035555654
[10] 0.066281983 0.014434349 0.049363589 0.070608399 0.005990335 0.032993882 0.001408913 0.089477719 0.048231967
[19] 0.105222468 0.029829408

test_pvalue < 0.05
table(test_pvalue < 0.05)

FALSE  TRUE 
    7    13

qvalue = p.adjust(test_pvalue,method = "BH")
table(qvalue < 0.05)
# å®é™…æ˜¾è‘—æ€§çš„åªæœ‰ä¸€ä¸ª
FALSE  TRUE 
   19     1 
```

### æ–¹å·®åˆ†æ(ç¦»æ•£å‹éšæœºå˜é‡)

#### ä¸ºä»€ä¹ˆè¿›è¡Œæ–¹å·®åˆ†æï¼Ÿ

ä¾‹å­ï¼šæŸç ”ç©¶è€…åœ¨æŸå•ä½å·¥ä½œäººå‘˜ä¸­è¿›è¡Œäº†ä½“é‡æŒ‡æ•°ï¼ˆBMIï¼‰æŠ½æ ·è°ƒæŸ¥ï¼ŒéšæœºæŠ½å–ä¸åŒå¹´é¾„ç»„ç”·æ€§å—è¯•è€…å„16åï¼Œæµ‹é‡äº†è¢«è°ƒæŸ¥è€…çš„èº«é«˜å’Œä½“é‡å€¼ï¼Œç”±æ­¤æŒ‰ç…§BMI=ä½“é‡/èº«é«˜2å…¬å¼è®¡ç®—äº†ä½“é‡æŒ‡æ•°ï¼Œè¯·é—®ï¼Œä¸åŒå¹´é¾„ç»„çš„ä½“é‡æŒ‡æ•°æœ‰æ— å·®å¼‚ï¼Ÿ

![LaZV1x](https://cdn.liguocheng.top//uPic/LaZV1x.png)

- ä¸¤ä¸¤æ¯”è¾ƒï¼Œç„¶åå†è¿›è¡Œæ ¡æ­£ï¼ˆP Valueæ ¡æ­£ï¼‰

- ç›´æ¥æ¯”è¾ƒï¼Œçœ‹æ˜¯æ˜¯å¦ç»„é—´å·®å¼‚å¤§äºç»„å†…å·®å¼‚ï¼ˆæ–¹å·®åˆ†æï¼‰

> æœ¬è´¨ä¸Šï¼Œæ–¹å·®åˆ†æä¹Ÿæ˜¯ä¸ºäº†é¿å…å¤šé‡æ£€éªŒçš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚
>
> è¦åˆ†æ¸…â€œå› ç´ â€ä¸â€œæ°´å¹³â€çš„æ¦‚å¿µã€‚æœ¬ä¾‹å­ä¸­çš„å¹´é¾„ä¸ºè¯¥è¯•éªŒçš„å› ç´ ï¼Œ3ä¸ªä¸åŒå¹´é¾„æ®µä¸º3ä¸ªä¸åŒæ°´å¹³ã€‚

æ€»å˜å¼‚= ç»„é—´å˜å¼‚+ ç»„å†…å˜å¼‚

æ€»å˜å¼‚(Total variation):  å…¨éƒ¨æµ‹é‡å€¼ä¸ğ‘‹ğ‘–ğ‘—æ€»å‡æ•°ğ‘‹é—´çš„å·®å¼‚

ç»„é—´å˜å¼‚(between group variation ):  å„ç»„çš„å‡æ•°ğ‘‹ğ‘–.ä¸æ€»å‡æ•°ğ‘‹é—´çš„å·®å¼‚

ç»„å†…å˜å¼‚ï¼ˆwithin group variation )ï¼šæ¯ç»„çš„æ¯ä¸ªæµ‹é‡å€¼ğ‘‹ğ‘–ğ‘—ä¸è¯¥ç»„å‡æ•°ğ‘‹ğ‘–.çš„å·®å¼‚

### å‡æ–¹å·®

å˜å¼‚ç¨‹åº¦é™¤ä¸ç¦»å‡å·®å¹³æ–¹å’Œçš„å¤§å°æœ‰å…³å¤–ï¼Œè¿˜ä¸å…¶è‡ªç”±åº¦æœ‰å…³ï¼Œç”±äºå„éƒ¨åˆ†è‡ªç”±åº¦ä¸ç›¸ç­‰ï¼Œå› æ­¤å„éƒ¨åˆ†ç¦»å‡å·®å¹³æ–¹å’Œä¸èƒ½ç›´æ¥æ¯”è¾ƒï¼Œé¡»å°†å„éƒ¨åˆ†ç¦»å‡å·®å¹³æ–¹å’Œé™¤ä»¥ç›¸åº”è‡ªç”±åº¦ï¼Œå…¶æ¯”å€¼ç§°ä¸ºå‡æ–¹å·®ï¼Œç®€ç§°å‡æ–¹(mean squareï¼ŒMS)ã€‚

ç»„é—´å‡æ–¹å’Œç»„å†…å‡æ–¹çš„è®¡ç®—å…¬å¼ä¸º:

MS~ç»„é—´~ = SS~ç»„é—´~/v~ç»„é—´~         MS~ç»„å†…~ = SS~ç»„å†…~/v~ç»„å†…~

> ä¸€èˆ¬è‡ªç”±åº¦ç­‰äºå¯ä»¥ç›¸å¯¹å¯ä»¥è‡ªç”±å˜æ¢çš„éšæœºå˜é‡çš„ä¸ªæ•°ã€‚

### æ–¹å·®åˆ†æçš„å‡è®¾æ£€éªŒæ€æƒ³

**é—®é¢˜è½¬æ¢**

- æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥è®¡ç®—MSç»„é—´ä¸MSç»„å†…çš„æ¯”å€¼ï¼›

- å¦‚æœä¸Šè¿°å„ç»„æ¥è‡ªåŒä¸€ä¸ªæ€»ä½“ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„è¯¯å·®åº”è¯¥éƒ½æ˜¯æ¥è‡ªäºéšæœºæŠ½æ ·ï¼Œå› æ­¤MSç»„é—´ä¸MSç»„å†…çš„æ¯”å€¼åº”è¯¥åœ¨1é™„è¿‘ï¼›

- å¦‚æœæ¥è‡ªäºä¸åŒæ€»ä½“ï¼Œä¹Ÿå³æŸä¸ªå› ç´ ç¡®å®å¯¹æŠ½æ ·çš„ç»“æœäº§ç”Ÿäº†å½±å“ï¼Œé‚£ä¹ˆMSç»„é—´ä¸MSç»„å†…çš„æ¯”å€¼åº”è¯¥æœ‰æ¯”è¾ƒå¤§çš„å·®å¼‚ï¼›

- å› æ­¤ï¼Œæœ€ç»ˆæˆ‘ä»¬å°†æ–¹å·®åˆ†æçš„é—®é¢˜è½¬æ¢æˆäº†MSç»„é—´ä¸MSç»„å†…çš„æ¯”å€¼æ£€éªŒé—®é¢˜ã€‚

æ„å»ºFç»Ÿè®¡é‡ä¸ºç»„é—´ä¸ç»„å†…MSçš„æ¯”å€¼ï¼š

F = MS~ç»„é—´~ / MS~ç»„å†…~

å¦‚æœå„ç»„æ ·æœ¬çš„æ€»ä½“å‡æ•°ç›¸ç­‰ï¼ˆH0æˆç«‹ï¼‰ï¼Œå³å„å¤„ç†ç»„çš„æ ·æœ¬æ¥è‡ªç›¸åŒæ€»ä½“ï¼Œæ— å¤„ç†å› ç´ çš„ä½œç”¨ï¼Œåˆ™ç»„é—´å˜å¼‚åŒç»„å†…å˜å¼‚ä¸€æ ·ï¼Œåªåæ˜ éšæœºè¯¯å·®ä½œç”¨çš„å¤§å°ã€‚ç»„é—´å‡æ–¹ä¸ç»„å†…å‡æ–¹çš„æ¯”å€¼ç§°ä¸ºFç»Ÿè®¡é‡ã€‚

Få€¼æ¥è¿‘äº1ï¼Œå°±æ²¡æœ‰ç†ç”±æ‹’ç»H0ï¼›åä¹‹ï¼ŒFå€¼è¶Šå¤§ï¼Œæ‹’ç» H0çš„ç†ç”±è¶Šå……åˆ†ã€‚æ•°ç†ç»Ÿè®¡çš„ç†è®ºè¯æ˜ï¼Œå½“H0æˆç«‹æ—¶ï¼ŒFç»Ÿè®¡é‡æœä»Fåˆ†å¸ƒã€‚

> Fåˆ†å¸ƒç”±ä¸¤ä¸ªè‡ªç”±åº¦å†³å®š
>
> Fåˆ†å¸ƒå…¶å®ä¸å¡æ–¹åˆ†å¸ƒå¯†ä¸å¯åˆ†

![0vjuj5](https://cdn.liguocheng.top//uPic/0vjuj5.png)

æœ€åæŸ¥Fåˆ†å¸ƒå¯¹åº”è‡ªç”±åº¦çš„è¡¨å¯ä»¥çŸ¥ï¼ŒÎ±~0.05~åœ¨3.20åˆ°3.21å·¦å³ï¼Œå°äº8.87ï¼Œå› æ­¤è¦æ‹’ç»H0ï¼Œå³è¯¥å¹´é¾„å› ç´ å¯¹BMIäº§ç”Ÿäº†å½±å“ã€‚

```R
# æ–¹å·®åˆ†æ
set.seed(2021)
BMI.1 = rnorm(16,22,9)

set.seed(2021)
BMI.2 = rnorm(16,26,8)

set.seed(2021)
BMI.3 = rnorm(16,28,7)

BMI.df = data.frame(BMI=c(BMI.1,BMI.2,BMI.3),
                    group = factor(rep(c(1,2,3),each=16)))

BMI.aov = aov(BMI ~ group, data = BMI.df)
BMI.aov

Call:
   aov(formula = BMI ~ group, data = BMI.df)

Terms:
                    group Residuals
Sum of Squares   378.7787 2309.4096
Deg. of Freedom         2        45

Residual standard error: 7.163813
Estimated effects may be unbalanced

summary(BMI.aov)

           Df Sum Sq Mean Sq F value Pr(>F)  
group        2  378.8  189.39    3.69 0.0328 *
Residuals   45 2309.4   51.32                 
---
Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
```



### æ–¹å·®åˆ†æä½¿ç”¨çš„åŸºæœ¬æ¡ä»¶

- å„ç»„æœä»æ­£æ€åˆ†å¸ƒï¼›

- å„ç»„ç¬¦åˆæ–¹å·®é½æ€§ï¼›

- ç‹¬ç«‹æ€§ï¼›

> æœ€å¤§æ–¹å·®ä¸æœ€å°æ–¹å·®ä¹‹æ¯”<3ï¼Œåˆæ­¥è®¤ä¸ºæ–¹å·®é½

> æ¯”å¦‚åœ¨åšåŒå› ç´ ä¸åŒæ°´å¹³çš„RNA-Seqï¼Œå°±å¯ä»¥ä½¿ç”¨æ–¹å·®åˆ†ææ¥åˆ¤å®šè¯¥å› ç´ æ˜¯å¦å¯¹æŸä¸ªåŸºå› æœ‰å½±å“ã€‚

## å›å½’åˆ†æ

> å›å½’æ˜¯æŒ‡åœ¨æŸä¸ªåŒºé—´å†…æ¥å›æ³¢åŠ¨çš„ç°è±¡ã€‚

### åˆ†ç±»

- ä¸€å…ƒçº¿æ€§å›å½’

- å¤šå…ƒçº¿æ€§å›å½’

- å¹¿ä¹‰çº¿æ€§å›å½’
  - Logistic å›å½’ç­‰

- ä¸ç¬¦åˆæœ€å°äºŒä¹˜æ³•çš„çº¿æ€§å›å½’
  - å²­å›å½’
  - Lassoå›å½’

### é‡è¦æ¦‚å¿µ

å˜é‡(Variable)

- æè¿°äº‹ç‰©ç‰¹å¾æˆ–ç‰¹è´¨çš„æ•°é‡æŒ‡æ ‡ï¼Œè¿™äº›æŒ‡æ ‡å› æ¡ä»¶ä¸åŒè€ŒæŒ‰ä¸€å®šçš„è§„å¾‹å˜åŒ–ï¼Œæ•…ç§°å˜é‡ã€‚

å˜é‡é—´çš„å…³ç³»(Relationships between variables)

- å‡½æ•°å…³ç³»(Functional relationship)

â€‹     æ¯”å¦‚æ¬§å§†å®šå¾‹ã€‚

- ç›¸å…³å…³ç³»(Correlation relationship) 

  å½“ä¸€ä¸ªå˜é‡å–å®šæŸä¸ªæ•°å€¼æ—¶ï¼Œå¦ä¸€ä¸ªå˜é‡å‡ºç°çš„å¯¹åº”å€¼ä¸æ˜¯å®Œå…¨ç¡®å®šçš„ã€‚å¦‚ï¼šæ–½æ°®é‡å’Œä½œç‰©ã€‚

### ä¸€å…ƒçº¿æ€§å›å½’

æˆ‘ä»¬è§‚å¯Ÿåˆ°çš„å˜é‡ï¼Œå› ä¸ºä¼šå—åˆ°éšæœºå› ç´ çš„å½±å“ï¼Œä»è€Œå‡ºç°ä¸€å®šçš„æ³¢åŠ¨ï¼Œå› æ­¤åœ¨åˆ†æé—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæŠŠè§‚å¯Ÿåˆ°çš„Yå€¼ç†è§£æˆâ€œèƒ½è§£é‡Šçš„éƒ¨åˆ†â€ä¸â€œéšæœºè¯¯å·®éƒ¨åˆ†â€çš„åŠ å’Œ

`ğ‘¦ = ğ‘ğ‘¥ + ğœ€`

æˆ‘ä»¬ä¸€èˆ¬è®¤ä¸ºï¼Œéšæœºè¯¯å·®éƒ¨åˆ†æ˜¯æœä»æ­£æ€åˆ†å¸ƒçš„ã€‚

![QZVnbF](https://cdn.liguocheng.top//uPic/QZVnbF.png)



### å›å½’ç³»æ•°ä¸æˆªè·çš„ç¡®å®š

ä¸€èˆ¬é€šè¿‡æœ€å°äºŒä¹˜åŸåˆ™æ¥ç¡®å®šğ‘ä¸ğ‘0å³ä½¿å¾—ï¼ŒQè¾¾åˆ°æœ€å°.

![7PPBIg](https://cdn.liguocheng.top//uPic/7PPBIg.png)

![image-20210707110217198](https://cdn.liguocheng.top//uPic/image-20210707110217198.png)

### å›å½’å…³ç³»çš„æ˜¾è‘—æ€§æ£€éªŒ

ä¸æ–¹å·®åˆ†æç±»ä¼¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠå›å½’ç»“æœçš„å·®å¼‚åˆ†æˆ2ä¸ªéƒ¨åˆ†ï¼š

æ€»å˜å¼‚= ç¦»å›å½’å˜å¼‚ï¼ˆå‰©ä½™å˜å¼‚) + å›å½’å˜å¼‚

ä¸æ–¹å·®åˆ†æç±»ä¼¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—SSå›å½’/Dfå›å½’ä¸SSå‰©ä½™/Dfå‰©ä½™çš„æ¯”å€¼ï¼Œå…¶ä¸­Dfè¡¨ç¤ºå¯¹åº”çš„å˜é‡çš„è‡ªç”±åº¦ï¼Œå› ä¸ºæ˜¯ä¸€å…ƒçº¿æ€§å›å½’ï¼Œæ‰€ä»¥è‡ªç”±åº¦åˆ†åˆ«æ˜¯1ä¸n-2ï¼Œnä¸ºå›å½’çš„ç‚¹ä¸ªæ•°

![image-20210707110513285](https://cdn.liguocheng.top//uPic/image-20210707110513285.png)

H0: ä¸¤ä¸ªå˜é‡é—´çš„çº¿æ€§å…³ç³»ä¸æ˜¾è‘—

H1: ä¸¤ä¸ªå˜é‡é—´çš„çº¿æ€§å…³ç³»æ˜¾è‘—

![image-20210707110814468](https://cdn.liguocheng.top//uPic/image-20210707110814468.png)

å¦‚æœæ¯”å€¼Fæ¯”è¾ƒå°ï¼Œè¯´æ˜å›å½’èƒ½è§£é‡Šçš„éƒ¨åˆ†ä¸ä¸èƒ½è§£é‡Šçš„éƒ¨åˆ†æ²¡æœ‰æ˜¾è‘—å·®å¼‚ï¼Œè¯æ˜çº¿æ€§å…³ç³»ä¸æ˜¾è‘—ï¼Œå¦åˆ™å°±éœ€è¦æ¥å—H1ï¼Œè®¤ä¸ºä¸¤ä¸ªå˜é‡æœ‰æ˜¾è‘—çš„ç›¸å…³æ€§ã€‚

```R
#çº¿æ€§å›å½’åˆ†æ
input.df = read.csv(file = "/Users/chandoubaxiaochongzi/Desktop/ç»Ÿè®¡å­¦ä¹ /ç”Ÿç‰©ä¿¡æ¯å­¦å…¥é—¨è¯¾ï¼šå­¦ä¹ ç”Ÿä¿¡ä½ éœ€è¦äº†è§£çš„ç»Ÿè®¡å­¦/lm_data.csv")
plot(input.df$x,input.df$y)

# run regression
lm.res = lm(y ~ x,data = input.df)
lm.res
Call:
lm(formula = y ~ x, data = input.df)

Coefficients:
(Intercept)            x  
   -0.82952      0.03789

summary(lm.res)

Call:
lm(formula = y ~ x, data = input.df)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.2882 -1.5233 -0.1802  0.8935  6.3038 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -0.82952    0.72304  -1.147    0.263    
x            0.03789    0.00503   7.534 1.18e-07 ***
---

abline(lm.res$coefficients)
```

![q8IJpu](https://cdn.liguocheng.top//uPic/q8IJpu.jpg)

### ä¸¤ä¸ªå˜é‡çš„ç›¸å…³ç³»æ•°

Pearsonç›¸å…³ç³»æ•°ï¼Œä¹Ÿå«Pearson r

![image-20210707112402406](https://cdn.liguocheng.top//uPic/image-20210707112402406.png)

### å†³å®šç³»æ•°

å¦‚ä½•è¡¡é‡æˆ‘ä»¬çš„å›å½’å¥½ä¸å¥½ï¼Ÿ

è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦è®¡ç®—R^2^ = SSå›å½’/SSæ€»

- R2å°±æ˜¯æ‰€è°“çš„â€œå†³å®šç³»æ•°â€

- åœ¨ä¸€å…ƒçº¿æ€§å›å½’æ—¶ï¼ŒR^2^ = r^2^

![image-20210707112928720](https://cdn.liguocheng.top//uPic/image-20210707112928720.png)

### Spearman ç›¸å…³ç³»æ•°

å¯¹ä¸¤ä¸ªå˜é‡æ’åºä»¥åçš„rankè¿›è¡Œè®¡ç®—Pearsonç›¸å…³ç³»æ•°ï¼Œè¢«ç§°ä¸ºSpearmanç›¸å…³ç³»æ•°ã€‚

Pearsonç›¸å…³ç³»æ•°åªèƒ½è¡¡é‡çº¿æ€§ç¨‹åº¦(ç­‰äº0å¹¶ä¸ä¸€å®šæ˜¯éç›¸å…³)ï¼Œè€ŒSpearmanç›¸å…³ç³»æ•°åˆ™åé‡è€ƒå¯Ÿä¸¤ä¸ªå˜é‡æ˜¯å¦æœ‰æ­£ç›¸å…³æˆ–è€…è´Ÿç›¸å…³ã€‚

```R
# correlation 
x = c(1:100)
y = x^10

cor(x,y,method = "pearson")
## [1] 0.6630055
cor(x,y,method = "spearman")
## [1] 1
```

## éå‚æ•°æ£€éªŒ

### ä»€ä¹ˆæ˜¯éå‚æ•°æ£€éªŒ

- å’Œæ•°æ®æœ¬èº«çš„æ€»ä½“åˆ†å¸ƒæ— å…³çš„æ£€éªŒç§°ä¸ºéå‚æ•°æ£€éªŒã€‚

- ä¸å‡å®šæ€»ä½“çš„å…·ä½“èƒŒæ™¯åˆ†å¸ƒå½¢å¼ï¼›

- å¤šæ ¹æ®æ•°æ®è§‚æµ‹å€¼çš„ç›¸å¯¹å¤§å°å»ºç«‹æ£€éªŒç»Ÿè®¡é‡ï¼Œç„¶åæ‰¾åˆ°åœ¨é›¶å‡è®¾ä¸‹è¿™äº›ç»Ÿè®¡é‡çš„åˆ†å¸ƒï¼Œçœ‹è¿™äº›ç»Ÿè®¡é‡çš„æ•°æ®å®ç°æ˜¯å¦åœ¨é›¶å‡è®¾ä¸‹å±äºå°æ¦‚ç‡äº‹ä»¶ã€‚

### ä¼˜ç¼ºç‚¹

- ä¼˜ç‚¹

> åœ¨æ€»ä½“åˆ†å¸ƒæœªçŸ¥æ—¶ï¼Œå¦‚æœè¿˜å‡å®šæ€»ä½“æœ‰è¯¸å¦‚æ­£æ€åˆ†å¸ƒé‚£æ ·çš„å·²çŸ¥åˆ†å¸ƒï¼Œåœ¨è¿›è¡Œç»Ÿè®¡æ¨æ–­å°±å¯èƒ½äº§ç”Ÿé”™è¯¯ç”šè‡³ç¾éš¾ã€‚
>
> éå‚æ•°æ£€éªŒæ€»æ˜¯æ¯”ä¼ ç»Ÿæ£€éªŒå®‰å…¨ï¼ˆæ›´ä¸å®¹æ˜“æ‹’ç»åŸå‡è®¾ï¼‰ã€‚

- ç¼ºç‚¹

> ä½†æ˜¯åœ¨æ€»ä½“åˆ†å¸ƒå½¢å¼å·²çŸ¥æ—¶ï¼Œéå‚æ•°æ£€éªŒä¸å¦‚ä¼ ç»Ÿæ–¹æ³•poweré«˜ã€‚

### é‡è¦çš„éå‚æ•°æ£€éªŒ

åŸºäºK. Pearsonæ‹Ÿåˆä¼˜åº¦çš„æ£€éªŒ

- åˆ—è”è¡¨æ£€éªŒ

- æ˜¯å¦æœä»å·²çŸ¥åˆ†å¸ƒçš„æ£€éªŒ

Wilcoxç§©å’Œæ£€éªŒ

Kolmogorov-Smirnovæ£€éªŒï¼ˆKSæ£€éªŒï¼‰

### Wilcoxç§©å’Œæ£€éªŒ

#### ä»€ä¹ˆæ˜¯ç§©(rank)ï¼Ÿ

ä¸€èˆ¬æ¥è¯´ï¼Œç§©å°±æ˜¯è¯¥æ•°æ®æŒ‰ç…§å‡åºæ’åˆ—ä¹‹åï¼Œæ¯ä¸ªè§‚æµ‹å€¼çš„ä½ç½®ã€‚å¦‚æœæœ‰æ’åºç›¸åŒçš„æƒ…å†µä¸‹ï¼Œå°±å–æ’åºä½ç½®å¤„çš„å¹³å‡å€¼ã€‚

![WLKgwL](https://cdn.liguocheng.top//uPic/WLKgwL.png)

#### Wilcoxç§©å’Œæ£€éªŒæ­¥éª¤(é…å¯¹æ ·æœ¬)

- è®¡ç®—æ ·æœ¬ä¸­æˆå¯¹æ•°æ®çš„å·®å€¼ï¼›

- è®¡ç®—å·®å€¼ç»å¯¹å€¼çš„ç§©ï¼›

- åˆ†åˆ«è®¡ç®—å‡ºå·®å€¼åºåˆ—ä¸­æ­£æ•°çš„ç§©å’ŒW +ä»¥åŠè´Ÿæ•°çš„ç§©å’ŒW -

- å¦‚æœä¸¤ä¸ªç§©å’Œæ¯”è¾ƒæ¥è¿‘ï¼Œåˆ™è¯´æ˜ä¹‹å‰å’Œä¹‹åæ²¡æœ‰æ˜¾è‘—å·®å¼‚.

æ ·æœ¬é‡å¾ˆå¤§æ—¶ï¼Œå¯ä»¥æ ¹æ®Wè®¡ç®—Zç»Ÿè®¡é‡ï¼Œä½¿ç”¨æ­£æ€åˆ†å¸ƒæ¥è¿‘ä¼¼è®¡ç®—

![6CJRhz](https://cdn.liguocheng.top//uPic/6CJRhz.png)

#### Wilcoxç§©å’Œæ£€éªŒæ­¥éª¤(éé…å¯¹æ ·æœ¬)

- å°†ä¸¤ä¸ªæ ·æœ¬çš„æ•°æ®æ··åˆåœ¨ä¸€èµ·æ’ç§©ï¼›

- åˆ†åˆ«è®¡ç®—ä¸¤ä¸ªæ ·æœ¬ä¸­æ•°æ®çš„ç§©å’Œï¼ˆrank sumï¼‰

- å¦‚æœä¸¤ä¸ªæ€»ä½“å…·æœ‰ç›¸åŒçš„ç»Ÿè®¡åˆ†å¸ƒï¼Œåˆ™æ¥è‡ªä¸¤ä¸ªæ ·æœ¬çš„ç§©å’Œåº”è¯¥æ¯”è¾ƒæ¥è¿‘ã€‚

```R
# wilcox test 
pre_ps = c(15.8,14.9,15.2,15.8,15.5,14.6,15,14.9,15.1,15.4)
after_ps = c(14.6,15.5,15.5,14.7,15.2,14.8,14.8,14.6,15.3,15.5)
wilcox.test(pre_ps,after_ps,paired = T)

Wilcoxon signed rank test with continuity correction

data:  pre_ps and after_ps
V = 33, p-value = 0.6091
alternative hypothesis: true location shift is not equal to 0
# éé…å¯¹æ ·æœ¬
wilcox.test(pre_ps,c(after_ps,10,20,30),paired = F)
```

### KS æ£€éªŒ

- Kolmogorov-Smirnovæ£€éªŒå±äºæ‹Ÿåˆä¼˜åº¦æ£€éªŒçš„ä¸€ç§ï¼›

- KSæ£€éªŒå¯ä»¥éå¸¸æ–¹ä¾¿åœ°æ£€éªŒæŠ½æ ·æ˜¯å¦æœä»æŸä¸€å·²çŸ¥åˆ†å¸ƒï¼›

- KSæ£€éªŒä¹Ÿå¯ä»¥ç›´æ¥æ¯”è¾ƒ2ä¸ªè¯•éªŒç»“æœæ˜¯å¦æ¥è‡ªåŒä¸€æ€»ä½“ã€‚

```R
# KS test
## æ˜¯å¦å±äºæŸä¸ªç†è®ºåˆ†å¸ƒ
time_vec = c(420,500,920,1380,1510,1650,1760,2100,2300,2350)
ks.test(time_vec,"pexp",1/1500)

One-sample Kolmogorov-Smirnov test

data:  time_vec
D = 0.30148, p-value = 0.2654
alternative hypothesis: two-sided

## ä¸¤ç»„è¯•éªŒæ˜¯å¦æ¥è‡ªåŒä¸€æ€»ä½“
b =rexp(1000,rate = 1/1500)
ks.test(time_vec,b)

Two-sample Kolmogorov-Smirnov test

data:  time_vec and b
D = 0.317, p-value = 0.2728
alternative hypothesis: two-sided
```



## Reference

https://ke.qq.com/course/395709

## License

Copyright 2021 [Guo-Cheng Li](https://moths.com). Released under the [MIT](https://github.com/gcushen/hugo-academic/blob/master/LICENSE.md) license.

